-- Teilaufgabe QL

-- Aufgabe 1
SELECT CNAME FROM COCKTAIL;

--Aufgabe 2
SELECT * FROM LOKAL WHERE PLZ=39108;

--Aufgabe 3
SELECT DISTINCT PLZ FROM LOKAL;

--Aufgabe 4
SELECT * FROM ZUTAT WHERE (ALKOHOLGEHALT BETWEEN 0 AND 50);
--Wenn man unter Zutat nur die Ausgabe des Namen versteht:
SELECT ZNAME FROM ZUTAT WHERE (ALKOHOLGEHALT BETWEEN 0 AND 50);

--Aufgabe 5
SELECT CNAME FROM COCKTAIL WHERE (CNAME LIKE '___%i');

--Aufgabe 6
(SELECT GNAME FROM GLAS) UNION (SELECT CNAME FROM COCKTAIL);
--Wenn der Tabellenkopf (bisher noch GNAME) angepasst werden soll:
(SELECT GNAME AS GNAME_CNAME FROM GLAS) UNION (SELECT CNAME FROM COCKTAIL);

--Aufgabe 7
(SELECT CID FROM COCKTAIL) MINUS (SELECT CID FROM ZUTAT_COCKTAIL);

--Aufgabe 8
--MINUS funktionierte nicht, da LNAME und LID verchiedene Datentypen haben
SELECT LNAME FROM LOKAL WHERE LID NOT IN(SELECT LID FROM COCKTAIL, COCKTAIL_LOKAL WHERE COCKTAIL.CID=COCKTAIL_LOKAL.CID AND CNAME='Zombie');

--Aufgabe 9
SELECT AVG(ALKOHOLGEHALT) FROM ZUTAT;

--Aufgabe 10
SELECT CID, COUNT(ZID) AS ANZ_ZUTATEN, MIN(MENGE) AS MINIMUM_MENGENEINHEITEN, MAX(MENGE) AS MAXIMUM_MENGENEINHEITEN, SUM(MENGE) AS SUMME_MENGENEINHEITEN FROM ZUTAT_COCKTAIL GROUP BY CID;

--Aufgabe 11
SELECT CID, SUM(ALKOHOLGEHALT*MENGE)/SUM(MENGE) AS ALKOHOLGEHALT FROM ZUTAT_COCKTAIL, ZUTAT WHERE ZUTAT_COCKTAIL.ZID = ZUTAT.ZID GROUP BY CID;

--Aufgabe 12
SELECT GNAME FROM GLAS,COCKTAIL WHERE GLAS.GID=COCKTAIL.GID GROUP BY GNAME HAVING COUNT(GLAS.GID)>2;

--------------------------------------------------------------------------------

--Teilaufgabe4 DDL DML

--Aufgabe 1
CREATE TABLE MEINE_COCKTAILS (
 CID number PRIMARY KEY,
 CNAME varchar2(20) NOT NULL,
 ALKOHOLISCH char(1) CHECK(ALKOHOLISCH='n' OR ALKOHOLISCH='y'),
 GID number NOT NULL,
 FOREIGN KEY (GID) REFERENCES GLAS (GID));
 
 INSERT INTO MEINE_COCKTAILS SELECT * FROM COCKTAIL;
  
 --Aufgabe 2
INSERT INTO MEINE_COCKTAILS VALUES (18,'Lila Kuh','y',2);
--Wenn man die GID von Schwenker nicht ablesen darf
--INSERT INTO MEINE_COCKTAILS SELECT 18,'Lila Kuh','y',GID FROM GLAS WHERE GNAME='Schwenker';

--Aufgabe 3
UPDATE MEINE_COCKTAILS SET CNAME='Blaue Kuh' WHERE (CNAME='Lila Kuh');

--Aufgabe 4 ????????
--DELETE FROM MEINE_COCKTAILS
Select * FROM MEINE_COCKTAILS WHERE CID IN (SELECT CID FROM ZUTAT_COCKTAIL, ZUTAT WHERE ZUTAT_COCKTAIL.ZID=ZUTAT.ZID AND ZNAME='Campari'); 
SELECT * FROM ZUTAT_COCKTAIL, ZUTAT WHERE ZUTAT_COCKTAIL.ZID=ZUTAT.ZID AND ZNAME='Campari';

--Aufgabe 5
CREATE VIEW CocktailAlkoholgehalt AS SELECT CID, SUM(ALKOHOLGEHALT*MENGE)/SUM(MENGE) AS ALKOHOLGEHALT FROM ZUTAT_COCKTAIL, ZUTAT GROUP BY CID;

--Aufgabe 6
GRANT ALL ON MEINE_COCKTAILS TO ANONYMOUS;

--Aufgabe 7
REVOKE DELETE ON MEINE_COCKTAILS FROM ANONYMOUS;
DROP TABLE MEINE_COCKTAILS;